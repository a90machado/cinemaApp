<div class="container-fluid details">
  <div class="row">
    <div class="col-sm-12 col-md-4 col-lg-3">
      <div class="text-center">
        <img class="card-img-top" style="height: 20rem;" src="{{ selectedMovie.image }}" alt="Card image cap">
        <br>
        <div>
          <button type="button" [ngStyle]="{'display': block}" (click)="buyClick(stepper)" class="btn btn-secondary">Buy
            Ticket</button>
        </div>
        <div class="text-center">
          <button type="button" id="btnReset" [ngStyle]="{'display': style}" (click)="resetClick()" class="btn btn-secondary">Reset</button>
        </div>
      </div>
    </div>
    <div class="col-sm-12 col-md-7 col-lg-8">
      <div class="">
        <h1>{{ selectedMovie.title }}</h1>
        <h5>M{{ selectedMovie.minimumAge }}</h5>
        <hr>
        <p><b>Duration (min.): </b>{{ selectedMovie.duration }}</p>
        <p><b>Release Date: </b>{{ formatDate }}</p>
        <p><b>Director: </b>{{ selectedMovie.director }}</p>
        <p><b>Cast: </b>{{ selectedMovie.cast}}</p>
        <hr>
        <p><b>Synopsis: </b> {{ selectedMovie.synopsis }}
        </p>
      </div>
    </div>
  </div>
</div>

<div [ngStyle]="{'display': style}">
  <hr>
  <mat-horizontal-stepper #stepper>
    <mat-step editable="false">
      <ng-template matStepLabel><b>Movie</b></ng-template>
      <label for="movie">{{ selectedMovie.title }}</label>
    </mat-step>
    <mat-step [editable]="editable">
      <ng-template matStepLabel><b>Cinema</b></ng-template>
      <mat-select name="cinemas" id="cinemas" [(ngModel)]="cinemas" placeholder="Select Cinema">
        <mat-option *ngFor="let cinema of cinemas | async" (click)="clickedCinema(cinema.id)">
          {{ cinema.name }}
        </mat-option>
      </mat-select>
    </mat-step>
    <mat-step [editable]="editable">
      <ng-template matStepLabel><b>Session</b></ng-template>
      <div class="table-responsive">
        <table class="table" [ngClass]='theme'>
          <thead>
          </thead>
          <tbody>
            <tr *ngFor="let exibitionDay of exibitionDays | async">
              <td>
                {{exibitionDay.dayOfWeek}}, Day{{exibitionDay.day}}
              </td>
              <td *ngFor="let room of rooms | async">
                Room {{room.id}}
              </td>
              <td>
                <p id="pSchedule" *ngFor="let schedule of schedules | async | scheduleDay:exibitionDay" (click)="clickSession(schedule.id)">
                  {{ dataForSelect(schedule.sessionBegin) }}
                </p>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </mat-step>
    <mat-step [editable]="editable">
      <ng-template matStepLabel><b>Ticket</b></ng-template>
      <div class="table-responsive">
        <table class="table" [ngClass]='theme'>
          <thead>
            <tr>
              <th *ngFor="let col of header">
                {{col}}
              </th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let row of typeOfTickets | async">
              <td>
                {{row.typeOfTicket}}
              </td>
              <td>
                {{row.priceOfTicket}} $
              </td>
              <td>
                <mat-select name="quantity" id="quantity" placeholder="Select Quantity">
                  <mat-option value="0" (click)=" clickQuantity(0,row.id)">
                      Select Quantity
                    </mat-option>
                  <mat-option *ngFor="let quantity of quantities" value="{{selectedQuantity}}" (click)=" clickQuantity(quantity,row.id)">
                    {{quantity}}
                  </mat-option>
                </mat-select>
              </td>
            </tr>
            
            Available Seats: {{availableSeats}}
             
            Tickets Selected: {{add}}  
            
            <p [ngStyle]="{'display': alertQtd}">Number of tickets is above the available seats</p>
          </tbody>
        </table>
        <button [ngStyle]="{'display': nextBtn}" (click)="clickNext()">Next</button>
      </div>
    </mat-step>
    <mat-step>
      <ng-template matStepLabel><b>Reserve Seat</b></ng-template>
      <mat-select [disabled]="rommDisplay" name="rooms" id="rooms" placeholder="Select room">
        <mat-option *ngFor="let room of rooms | async" value="{{selectedRoom}}" (click)="clickRoom(room.id)">
          Room {{room.id}}
        </mat-option>
      </mat-select>
      <table id="structure" class="table" [ngClass]='theme'>
          <thead>
          </thead>
          <tbody>
            <tr *ngFor="let queue of rooms | async | structurePipe:roomId:1; let i = index">
              <td id="colStructure" *ngFor="let seats of rooms | async | structurePipe:roomId:2; let j = index">
                <i *ngIf="getStructure(i,j)=='free'"  class="material-icons" (click)="reserveSeat(i,j)">event_seat</i>
                <i *ngIf="getStructure(i,j)=='occupied'" class="material-icons">account_box</i>
                <i *ngIf="getStructure(i,j)=='reserved'" class="material-icons" (click)="unreserveSeat(i,j)">check_circle</i>
              </td>
            </tr>           
          </tbody>
      </table>
        Seats to Choose: {{add}}
        <button [ngStyle]="{'display': seatsBtn}" (click)="clickforLast()">Next</button>  
    </mat-step>
    <mat-step>
      <ng-template matStepLabel><b>Purchase</b></ng-template>
      <button (click)="postInformation()">Finnish Process</button>  
    </mat-step>
  </mat-horizontal-stepper>
</div>